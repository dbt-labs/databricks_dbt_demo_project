version: 2

metrics:
  - name: avg_supplier_cycle_days
    label: Average Supplier Cycle Days
    model: ref('order_items')
    description: "This is the average amount of days it took suppliers to ship our orders from order date"
    meta:
      owner: Operations

    calculation_method: average
    expression: datediff(ship_date, order_date)  

    timestamp: order_date
    time_grains: [day, week, month, quarter, year]

    dimensions:
      - supplier_key
      - ship_mode

    filters:
      - field: order_date
        operator: '<'
        value: "'2012-12-30'"

  
  - name: total_shipped_orders
    label: Total Shipped Orders
    model: ref('order_items')
    description: ""

    calculation_method: count_distinct
    expression: order_key  

    timestamp: order_date
    time_grains: [day, week, month, quarter, year]

    dimensions:
      - supplier_key
      - ship_mode

    filters:
      - field: ship_date
        operator: 'is'
        value: "not null"
      - field: order_date
        operator: '<'
        value: "'2012-12-30'"

models:
 - name: supplier_performance
   description: Suppliers average cycle time and quantity of shipped orders


